import{_ as a,d as t,r as e,o as s,A as o,bn as l,bo as i,E as n,bp as r,bq as m,br as d,G as c,c as u,e as g,f as p,x as b,t as v,i as y,F as h,h as D,n as f,p as L,j as _,bs as C,bt as w,bu as I,k as V,l as T,bv as k,z as x}from"./index-0769d9a3.js";import{E as j}from"./el-dialog-2eeeae26.js";import{E as S}from"./el-button-467e1438.js";import{a as N}from"./anime.es-826e4a6c.js";const E=a=>(L("data-v-1db5a8a8"),a=a(),_(),a),H={class:"blogDetailContainer"},q={class:"edit"},M=["src"],U=E((()=>p("img",{src:"http://hyyyh.top:3001/icon/comment.png",alt:""},null,-1))),z={class:"content"},A={class:"content_container"},F={class:"title"},G={class:"time"},R={class:"cover"},B=["src"],J=["innerHTML"],K={class:"comment"},O={class:"myComment"},P=E((()=>p("h2",null,"评论",-1))),Q={class:"sendComment"},W=x("发表评论"),X={class:"allComment"},Y=E((()=>p("h2",null,"全部评论",-1))),Z={key:0,class:"nomorecomment"},$={class:"allComment_item_left"},aa=["src"],ta={class:"allComment_item_right"},ea={class:"allComment_item_name"},sa={class:"allComment_item_container"},oa={class:"dialog-footer"},la=x("取消"),ia=x("确定");var na=a(t({__name:"blogdetail",setup(a){const t=e({blogData:[],isLaud:!1,commentInput:"",commentData:[],isToLoginVisible:!1,toLoginDialogText:"",LaudNum:0,userid:parseInt(localStorage.getItem("id")),isdisplay:!1});s((async()=>{const a=parseInt(o.currentRoute.value.params.id),e=await l(a),s=await i(a);if(200!=e.status||201==s.status)return n.error(e.data.msg),n.error(s.data.msg);e.data.data[0].container=e.data.data[0].container.replace("<pre>","<pre style='background-color:rgb(33,37,43);color:white;padding:1rem;min-width:600px'>"),t.blogData=e.data.data[0],t.commentData=s.data.data;const d=await r(t.blogData.id);200==d.status&&(t.LaudNum=d.data.length);(await m(t.blogData.id,t.userid)).data.is||(t.isLaud=!t.isLaud),t.isdisplay=!0,N({targets:[".blogDetailbody"],left:"0rem",duration:1e3})}));const L=()=>{t.isToLoginVisible=!1,o.push({path:"/login"})},_=()=>{document.querySelector(".comment").scrollIntoView({behavior:"smooth"})},x=async()=>{if(!t.blogData||!t.commentInput)return n.error("内容不能为空！");if(!(await E()))return t.toLoginDialogText="你当前尚未登录无法评论，是否前往登录页面？",void(t.isToLoginVisible=!0);{const a=await w(t.blogData.createuserid,t.blogData.id,t.commentInput,t.blogData.createusername,t.blogData.name);if(t.commentInput="",200==a.status)return n.success(a.data.msg),t.commentData=a.data.data,void t.blogData.commentnum++;n.error(a.data.msg)}},E=async()=>{if(localStorage.getItem("id")||localStorage.getItem("token")||localStorage.getItem("name")){return 201!=(await I()).data.status}return!1};return(a,e)=>{const s=d,o=c,l=S,i=j;return V(),u("div",H,[g(T,{bgColor:!0}),p("div",{class:"blogDetailbody",style:f({opacity:t.isdisplay?"1":"0"})},[p("div",q,[p("div",{onClick:e[0]||(e[0]=a=>(async()=>{if(await E()){const a=t.blogData.id;if(!(await m(a,t.userid)).data.is)return void n.error("你已经点过赞了！");const e=await C(a,t.userid);return 201==e.data.status?void n.error(e.data.msg):(n.success(e.data.msg),t.LaudNum++,void(t.isLaud=!t.isLaud))}return t.toLoginDialogText="你当前尚未登录无法点赞，是否前往登录页面？",void(t.isToLoginVisible=!0)})())},[g(s,{value:t.LaudNum,class:"item"},{default:b((()=>[p("img",{src:t.isLaud?"http://hyyyh.top:3001/icon/laud_0.png":"http://hyyyh.top:3001/icon/laud.png"},null,8,M)])),_:1},8,["value"])]),p("div",{onClick:_},[g(s,{value:t.blogData.commentnum,class:"item"},{default:b((()=>[U])),_:1},8,["value"])])]),p("div",z,[p("div",A,[p("h1",F,v(t.blogData.name),1),p("h4",G,"创建时间："+v(t.blogData.createtime),1),p("div",R,[p("img",{src:t.blogData.img,alt:""},null,8,B)]),p("div",{innerHTML:t.blogData.container,class:"blogdetailContainerHtml"},null,8,J)]),p("div",K,[p("div",O,[P,g(o,{modelValue:t.commentInput,"onUpdate:modelValue":e[1]||(e[1]=a=>t.commentInput=a),placeholder:"请输入你的评论",type:"textarea",height:"100px"},null,8,["modelValue"]),p("div",Q,[g(l,{type:"primary",onClick:x},{default:b((()=>[W])),_:1})])]),p("div",X,[Y,0==t.commentData.length?(V(),u("p",Z," 暂无评论 ")):y("",!0),p("div",null,[(V(!0),u(h,null,D(t.commentData,((a,t)=>(V(),u("div",{class:"allComment_item",key:t},[p("div",$,[p("div",null,[p("img",{src:a.avatar||"http://hyyyh.top:3001/icon/github.png",alt:""},null,8,aa)])]),p("div",ta,[p("div",ea,[p("span",null,v(a.blogusername),1),p("span",null,v(a.createtime),1)]),p("div",sa,v(a.container),1)])])))),128))])])])]),g(k,{style:{"margin-top":"1rem"}}),g(i,{modelValue:t.isToLoginVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>t.isToLoginVisible=a),title:"登陆提示",width:"20%",top:"20rem","show-close":!1,"lock-scroll":!1},{footer:b((()=>[p("span",oa,[g(l,{onClick:e[2]||(e[2]=a=>t.isToLoginVisible=!1)},{default:b((()=>[la])),_:1}),g(l,{type:"success",onClick:L},{default:b((()=>[ia])),_:1})])])),default:b((()=>[p("span",null,v(t.toLoginDialogText),1)])),_:1},8,["modelValue"])],4)])}}}),[["__scopeId","data-v-1db5a8a8"]]);export{na as default};
