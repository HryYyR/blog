import{_ as a,d as t,r as e,o as s,A as o,bx as i,by as l,E as n,bz as r,bA as m,bB as d,c,e as u,f as g,x as p,t as b,i as v,F as y,h,n as f,p as D,j as L,bC as _,bD as C,bE as w,k as I,l as V,bF as x,z as T}from"./index-227f788f.js";import{E as k}from"./el-overlay-30a39b5c.js";import{E as j}from"./el-button-a0f42afa.js";import{E}from"./el-input-b1854884.js";import{a as S}from"./anime.es-826e4a6c.js";import"./index-f6cae80c.js";import"./index-43ca881a.js";const N=a=>(D("data-v-1db5a8a8"),a=a(),L(),a),H={class:"blogDetailContainer"},z={class:"edit"},A=["src"],F=N((()=>g("img",{src:"http://hyyyh.top:3001/icon/comment.png",alt:""},null,-1))),M={class:"content"},U={class:"content_container"},q={class:"title"},B={class:"time"},R={class:"cover"},G=["src"],J=["innerHTML"],K={class:"comment"},O={class:"myComment"},P=N((()=>g("h2",null,"评论",-1))),Q={class:"sendComment"},W=T("发表评论"),X={class:"allComment"},Y=N((()=>g("h2",null,"全部评论",-1))),Z={key:0,class:"nomorecomment"},$={class:"allComment_item_left"},aa=["src"],ta={class:"allComment_item_right"},ea={class:"allComment_item_name"},sa={class:"allComment_item_container"},oa={class:"dialog-footer"},ia=T("取消"),la=T("确定");var na=a(t({__name:"blogdetail",setup(a){const t=e({blogData:[],isLaud:!1,commentInput:"",commentData:[],isToLoginVisible:!1,toLoginDialogText:"",LaudNum:0,userid:parseInt(localStorage.getItem("id")),isdisplay:!1});s((async()=>{const a=parseInt(o.currentRoute.value.params.id),e=await i(a),s=await l(a);if(200!=e.status||201==s.status)return n.error(e.data.msg),n.error(s.data.msg);e.data.data[0].container=e.data.data[0].container.replace("<pre>","<pre style='background-color:rgb(33,37,43);color:white;padding:1rem;min-width:600px'>"),t.blogData=e.data.data[0],t.commentData=s.data.data;const d=await r(t.blogData.id);200==d.status&&(t.LaudNum=d.data.length);(await m(t.blogData.id,t.userid)).data.is||(t.isLaud=!t.isLaud),t.isdisplay=!0,S({targets:[".blogDetailbody"],left:"0rem",duration:1e3})}));const D=()=>{t.isToLoginVisible=!1,o.push({path:"/login"})},L=()=>{document.querySelector(".comment").scrollIntoView({behavior:"smooth"})},T=async()=>{if(!t.blogData||!t.commentInput)return n.error("内容不能为空！");if(!(await N()))return t.toLoginDialogText="你当前尚未登录无法评论，是否前往登录页面？",void(t.isToLoginVisible=!0);{const a=await C(t.blogData.createuserid,t.blogData.id,t.commentInput,t.blogData.createusername,t.blogData.name);if(t.commentInput="",200==a.status)return n.success(a.data.msg),t.commentData=a.data.data,void t.blogData.commentnum++;n.error(a.data.msg)}},N=async()=>{if(localStorage.getItem("id")||localStorage.getItem("token")||localStorage.getItem("name")){return 201!=(await w()).data.status}return!1};return(a,e)=>{const s=d,o=E,i=j,l=k;return I(),c("div",H,[u(V,{bgColor:!0}),g("div",{class:"blogDetailbody",style:f({opacity:t.isdisplay?"1":"0"})},[g("div",z,[g("div",{onClick:e[0]||(e[0]=a=>(async()=>{if(await N()){const a=t.blogData.id;if(!(await m(a,t.userid)).data.is)return void n.error("你已经点过赞了！");const e=await _(a,t.userid);return 201==e.data.status?void n.error(e.data.msg):(n.success(e.data.msg),t.LaudNum++,void(t.isLaud=!t.isLaud))}return t.toLoginDialogText="你当前尚未登录无法点赞，是否前往登录页面？",void(t.isToLoginVisible=!0)})())},[u(s,{value:t.LaudNum,class:"item"},{default:p((()=>[g("img",{src:t.isLaud?"http://hyyyh.top:3001/icon/laud_0.png":"http://hyyyh.top:3001/icon/laud.png"},null,8,A)])),_:1},8,["value"])]),g("div",{onClick:L},[u(s,{value:t.blogData.commentnum,class:"item"},{default:p((()=>[F])),_:1},8,["value"])])]),g("div",M,[g("div",U,[g("h1",q,b(t.blogData.name),1),g("h4",B,"创建时间："+b(t.blogData.createtime),1),g("div",R,[g("img",{src:t.blogData.img,alt:""},null,8,G)]),g("div",{innerHTML:t.blogData.container,class:"blogdetailContainerHtml"},null,8,J)]),g("div",K,[g("div",O,[P,u(o,{modelValue:t.commentInput,"onUpdate:modelValue":e[1]||(e[1]=a=>t.commentInput=a),placeholder:"请输入你的评论",type:"textarea",height:"100px"},null,8,["modelValue"]),g("div",Q,[u(i,{type:"primary",onClick:T},{default:p((()=>[W])),_:1})])]),g("div",X,[Y,0==t.commentData.length?(I(),c("p",Z," 暂无评论 ")):v("",!0),g("div",null,[(I(!0),c(y,null,h(t.commentData,((a,t)=>(I(),c("div",{class:"allComment_item",key:t},[g("div",$,[g("div",null,[g("img",{src:a.avatar||"http://hyyyh.top:3001/icon/github.png",alt:""},null,8,aa)])]),g("div",ta,[g("div",ea,[g("span",null,b(a.blogusername),1),g("span",null,b(a.createtime),1)]),g("div",sa,b(a.container),1)])])))),128))])])])]),u(x,{style:{"margin-top":"1rem"}}),u(l,{modelValue:t.isToLoginVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>t.isToLoginVisible=a),title:"登陆提示",width:"20%",top:"20rem","show-close":!1,"lock-scroll":!1},{footer:p((()=>[g("span",oa,[u(i,{onClick:e[2]||(e[2]=a=>t.isToLoginVisible=!1)},{default:p((()=>[ia])),_:1}),u(i,{type:"success",onClick:D},{default:p((()=>[la])),_:1})])])),default:p((()=>[g("span",null,b(t.toLoginDialogText),1)])),_:1},8,["modelValue"])],4)])}}}),[["__scopeId","data-v-1db5a8a8"]]);export{na as default};
