import{_ as a,d as t,r as e,o as s,A as o,bo as l,bp as i,E as n,bq as r,br as m,bs as d,G as c,c as u,e as g,f as p,h as b,x as v,t as y,j as h,F as D,i as f,n as L,p as _,k as w,bt as C,bu as I,bv as V,bw as T,l as x,bx as k,z as j}from"./index-26b86a81.js";import{E as S}from"./el-dialog-1a4b5cf1.js";import{E as N}from"./el-button-bf5e0c7c.js";import{a as E}from"./anime.es-826e4a6c.js";const H=a=>(_("data-v-4a230094"),a=a(),w(),a),q={class:"blogDetailContainer"},A={class:"edit"},M=["src"],U=H((()=>b("img",{src:"http://hyyyh.top:3001/icon/comment.png",alt:""},null,-1))),z={class:"content"},F={class:"content_container"},G={class:"title"},R={class:"time"},B={class:"cover"},J=["src"],K=["innerHTML"],O={class:"comment"},P={class:"myComment"},Q=H((()=>b("h2",null,"评论",-1))),W={class:"sendComment"},X=j("发表评论"),Y={class:"allComment"},Z=H((()=>b("h2",null,"全部评论",-1))),$={key:0,class:"nomorecomment"},aa={class:"allComment_item_left"},ta=["src"],ea={class:"allComment_item_right"},sa={class:"allComment_item_name"},oa={class:"allComment_item_container"},la={class:"dialog-footer"},ia=j("取消"),na=j("确定");var ra=a(t({__name:"blogdetail",setup(a){const t=e({blogData:[],isLaud:!1,commentInput:"",commentData:[],isToLoginVisible:!1,toLoginDialogText:"",LaudNum:0,userid:parseInt(localStorage.getItem("id")),isdisplay:!1});s((async()=>{const a=parseInt(o.currentRoute.value.params.id),e=await l(a),s=await i(a);if(200!=e.status||201==s.status)return n.error(e.data.msg),n.error(s.data.msg);e.data.data[0].container=e.data.data[0].container.replaceAll("<pre>","<pre style='background-color:rgb(33,37,43);color:white;padding:1rem;min-width:600px;border-radius:10px'>"),t.blogData=e.data.data[0],t.commentData=s.data.data;const d=await r(t.blogData.id);200==d.status&&(t.LaudNum=d.data.length);(await m(t.blogData.id,t.userid)).data.is||(t.isLaud=!t.isLaud),t.isdisplay=!0,E({targets:[".blogDetailbody"],left:"0rem",duration:1e3})}));const _=()=>{t.isToLoginVisible=!1,o.push({path:"/login"})},w=()=>{document.querySelector(".comment").scrollIntoView({behavior:"smooth"})},j=async()=>{if(!t.blogData||!t.commentInput)return n.error("内容不能为空！");if(!(await H()))return t.toLoginDialogText="你当前尚未登录无法评论，是否前往登录页面？",void(t.isToLoginVisible=!0);{const a=await I(V.state.userid,t.blogData.id,t.commentInput,t.blogData.createusername,t.blogData.name);if(t.commentInput="",200==a.status)return n.success(a.data.msg),t.commentData=a.data.data,void t.blogData.commentnum++;n.error(a.data.msg)}},H=async()=>{if(localStorage.getItem("id")||localStorage.getItem("token")||localStorage.getItem("name")){return 201!=(await T()).data.status}return!1};return(a,e)=>{const s=d,o=c,l=N,i=S;return u(),g("div",q,[p(x,{bgColor:!0}),b("div",{class:"blogDetailbody",style:L({opacity:t.isdisplay?"1":"0"})},[b("div",A,[b("div",{onClick:e[0]||(e[0]=a=>(async()=>{if(await H()){const a=t.blogData.id;if(!(await m(a,t.userid)).data.is)return void n.error("你已经点过赞了！");const e=await C(a,t.userid);return 201==e.data.status?void n.error(e.data.msg):(n.success(e.data.msg),t.LaudNum++,void(t.isLaud=!t.isLaud))}return t.toLoginDialogText="你当前尚未登录无法点赞，是否前往登录页面？",void(t.isToLoginVisible=!0)})())},[p(s,{value:t.LaudNum,class:"item"},{default:v((()=>[b("img",{src:t.isLaud?"http://hyyyh.top:3001/icon/laud_0.png":"http://hyyyh.top:3001/icon/laud.png"},null,8,M)])),_:1},8,["value"])]),b("div",{onClick:w},[p(s,{value:t.blogData.commentnum,class:"item"},{default:v((()=>[U])),_:1},8,["value"])])]),b("div",z,[b("div",F,[b("h1",G,y(t.blogData.name),1),b("h4",R,"创建时间："+y(t.blogData.createtime),1),b("div",B,[b("img",{src:t.blogData.img,alt:""},null,8,J)]),b("div",{innerHTML:t.blogData.container,class:"blogdetailContainerHtml"},null,8,K)]),b("div",O,[b("div",P,[Q,p(o,{modelValue:t.commentInput,"onUpdate:modelValue":e[1]||(e[1]=a=>t.commentInput=a),placeholder:"请输入你的评论",type:"textarea",height:"100px"},null,8,["modelValue"]),b("div",W,[p(l,{type:"primary",onClick:j},{default:v((()=>[X])),_:1})])]),b("div",Y,[Z,0==t.commentData.length?(u(),g("p",$," 暂无评论 ")):h("",!0),b("div",null,[(u(!0),g(D,null,f(t.commentData,((a,t)=>(u(),g("div",{class:"allComment_item",key:t},[b("div",aa,[b("div",null,[b("img",{src:a.avatar||"http://hyyyh.top:3001/icon/github.png",alt:""},null,8,ta)])]),b("div",ea,[b("div",sa,[b("span",null,y(a.blogusername),1),b("span",null,y(a.createtime),1)]),b("div",oa,y(a.container),1)])])))),128))])])])]),p(k,{style:{"margin-top":"1rem"}}),p(i,{modelValue:t.isToLoginVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>t.isToLoginVisible=a),title:"登陆提示",width:"20%",top:"20rem","show-close":!1,"lock-scroll":!1},{footer:v((()=>[b("span",la,[p(l,{onClick:e[2]||(e[2]=a=>t.isToLoginVisible=!1)},{default:v((()=>[ia])),_:1}),p(l,{type:"success",onClick:_},{default:v((()=>[na])),_:1})])])),default:v((()=>[b("span",null,y(t.toLoginDialogText),1)])),_:1},8,["modelValue"])],4)])}}}),[["__scopeId","data-v-4a230094"]]);export{ra as default};
