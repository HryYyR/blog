import{_ as a,d as t,r as e,o as s,A as o,bn as l,bo as i,E as n,bp as r,bq as m,br as d,G as c,c as u,e as g,f as p,x as b,t as v,i as y,F as h,h as f,n as D,p as L,j as _,bs as w,bt as C,bu as I,bv as V,k as T,l as k,bw as x,z as j}from"./index-60b8dadd.js";import{E as S}from"./el-dialog-7d826188.js";import{E as N}from"./el-button-51711d00.js";import{a as E}from"./anime.es-826e4a6c.js";const H=a=>(L("data-v-877bff6a"),a=a(),_(),a),q={class:"blogDetailContainer"},M={class:"edit"},U=["src"],z=H((()=>p("img",{src:"http://hyyyh.top:3001/icon/comment.png",alt:""},null,-1))),A={class:"content"},F={class:"content_container"},G={class:"title"},R={class:"time"},B={class:"cover"},J=["src"],K=["innerHTML"],O={class:"comment"},P={class:"myComment"},Q=H((()=>p("h2",null,"评论",-1))),W={class:"sendComment"},X=j("发表评论"),Y={class:"allComment"},Z=H((()=>p("h2",null,"全部评论",-1))),$={key:0,class:"nomorecomment"},aa={class:"allComment_item_left"},ta=["src"],ea={class:"allComment_item_right"},sa={class:"allComment_item_name"},oa={class:"allComment_item_container"},la={class:"dialog-footer"},ia=j("取消"),na=j("确定");var ra=a(t({__name:"blogdetail",setup(a){const t=e({blogData:[],isLaud:!1,commentInput:"",commentData:[],isToLoginVisible:!1,toLoginDialogText:"",LaudNum:0,userid:parseInt(localStorage.getItem("id")),isdisplay:!1});s((async()=>{const a=parseInt(o.currentRoute.value.params.id),e=await l(a),s=await i(a);if(200!=e.status||201==s.status)return n.error(e.data.msg),n.error(s.data.msg);e.data.data[0].container=e.data.data[0].container.replace("<pre>","<pre style='background-color:rgb(33,37,43);color:white;padding:1rem;min-width:600px'>"),t.blogData=e.data.data[0],t.commentData=s.data.data;const d=await r(t.blogData.id);200==d.status&&(t.LaudNum=d.data.length);(await m(t.blogData.id,t.userid)).data.is||(t.isLaud=!t.isLaud),t.isdisplay=!0,E({targets:[".blogDetailbody"],left:"0rem",duration:1e3})}));const L=()=>{t.isToLoginVisible=!1,o.push({path:"/login"})},_=()=>{document.querySelector(".comment").scrollIntoView({behavior:"smooth"})},j=async()=>{if(!t.blogData||!t.commentInput)return n.error("内容不能为空！");if(!(await H()))return t.toLoginDialogText="你当前尚未登录无法评论，是否前往登录页面？",void(t.isToLoginVisible=!0);{const a=await C(I.state.userid,t.blogData.id,t.commentInput,t.blogData.createusername,t.blogData.name);if(t.commentInput="",200==a.status)return n.success(a.data.msg),t.commentData=a.data.data,void t.blogData.commentnum++;n.error(a.data.msg)}},H=async()=>{if(localStorage.getItem("id")||localStorage.getItem("token")||localStorage.getItem("name")){return 201!=(await V()).data.status}return!1};return(a,e)=>{const s=d,o=c,l=N,i=S;return T(),u("div",q,[g(k,{bgColor:!0}),p("div",{class:"blogDetailbody",style:D({opacity:t.isdisplay?"1":"0"})},[p("div",M,[p("div",{onClick:e[0]||(e[0]=a=>(async()=>{if(await H()){const a=t.blogData.id;if(!(await m(a,t.userid)).data.is)return void n.error("你已经点过赞了！");const e=await w(a,t.userid);return 201==e.data.status?void n.error(e.data.msg):(n.success(e.data.msg),t.LaudNum++,void(t.isLaud=!t.isLaud))}return t.toLoginDialogText="你当前尚未登录无法点赞，是否前往登录页面？",void(t.isToLoginVisible=!0)})())},[g(s,{value:t.LaudNum,class:"item"},{default:b((()=>[p("img",{src:t.isLaud?"http://hyyyh.top:3001/icon/laud_0.png":"http://hyyyh.top:3001/icon/laud.png"},null,8,U)])),_:1},8,["value"])]),p("div",{onClick:_},[g(s,{value:t.blogData.commentnum,class:"item"},{default:b((()=>[z])),_:1},8,["value"])])]),p("div",A,[p("div",F,[p("h1",G,v(t.blogData.name),1),p("h4",R,"创建时间："+v(t.blogData.createtime),1),p("div",B,[p("img",{src:t.blogData.img,alt:""},null,8,J)]),p("div",{innerHTML:t.blogData.container,class:"blogdetailContainerHtml"},null,8,K)]),p("div",O,[p("div",P,[Q,g(o,{modelValue:t.commentInput,"onUpdate:modelValue":e[1]||(e[1]=a=>t.commentInput=a),placeholder:"请输入你的评论",type:"textarea",height:"100px"},null,8,["modelValue"]),p("div",W,[g(l,{type:"primary",onClick:j},{default:b((()=>[X])),_:1})])]),p("div",Y,[Z,0==t.commentData.length?(T(),u("p",$," 暂无评论 ")):y("",!0),p("div",null,[(T(!0),u(h,null,f(t.commentData,((a,t)=>(T(),u("div",{class:"allComment_item",key:t},[p("div",aa,[p("div",null,[p("img",{src:a.avatar||"http://hyyyh.top:3001/icon/github.png",alt:""},null,8,ta)])]),p("div",ea,[p("div",sa,[p("span",null,v(a.blogusername),1),p("span",null,v(a.createtime),1)]),p("div",oa,v(a.container),1)])])))),128))])])])]),g(x,{style:{"margin-top":"1rem"}}),g(i,{modelValue:t.isToLoginVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>t.isToLoginVisible=a),title:"登陆提示",width:"20%",top:"20rem","show-close":!1,"lock-scroll":!1},{footer:b((()=>[p("span",la,[g(l,{onClick:e[2]||(e[2]=a=>t.isToLoginVisible=!1)},{default:b((()=>[ia])),_:1}),g(l,{type:"success",onClick:L},{default:b((()=>[na])),_:1})])])),default:b((()=>[p("span",null,v(t.toLoginDialogText),1)])),_:1},8,["modelValue"])],4)])}}}),[["__scopeId","data-v-877bff6a"]]);export{ra as default};
