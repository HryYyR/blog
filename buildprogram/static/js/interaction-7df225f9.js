import{d as v,r as x,c as u,e as l,f as a,u as _,h as n,t as d,x as F,y as p,z as D,_ as E,o as B,A,B as k,F as f,i as C,p as V,k as I,E as s,C as S,l as $,D as j,G as L,H as z}from"./index-22c1370a.js";import{E as w}from"./el-button-29d321e0.js";import{E as R}from"./el-input-bbeb8ece.js";import{a as T}from"./anime.es-826e4a6c.js";import{E as N}from"./el-overlay-58b8d811.js";import"./index-b790c75a.js";import"./index-896fe500.js";const M={class:"dialog-footer"},U=p("\u53D6\u6D88"),G=p("\u786E\u5B9A"),H=v({__name:"tologindialog",props:{isshow:{type:Boolean,default:!1},info:{type:String,default:'"\u4F60\u5F53\u524D\u5C1A\u672A\u767B\u5F55\u65E0\u6CD5\u70B9\u8D5E\uFF0C\u662F\u5426\u524D\u5F80\u767B\u5F55\u9875\u9762\uFF1F"'}},emits:["back"],setup(c,{emit:t}){const b=x({toLoginDialogText:"",isToLoginVisible:!1}),h=()=>{b.isToLoginVisible=!1,D.push({path:"/login"})};return(y,i)=>{const e=w,r=N;return u(),l("div",null,[a(r,{modelValue:c.isshow,"onUpdate:modelValue":i[1]||(i[1]=m=>F(isshow)?isshow.value=m:null),title:"\u767B\u9646\u63D0\u793A",width:"20%",top:"20rem","show-close":!1,"lock-scroll":!1},{footer:_(()=>[n("span",M,[a(e,{onClick:i[0]||(i[0]=m=>t("back"))},{default:_(()=>[U]),_:1}),a(e,{type:"success",onClick:h},{default:_(()=>[G]),_:1})])]),default:_(()=>[n("span",null,d(c.info),1)]),_:1},8,["modelValue"])])}}});const g=c=>(V("data-v-bc3483a4"),c=c(),I(),c),Y={class:"interaction_container"},q={class:"interaction_body"},J={class:"interaction_body_container"},K=g(()=>n("h1",null,"\u7559\u8A00\u677F",-1)),O={class:"interaction__inputbody"},P={class:"interaction__btnbody"},Q=g(()=>n("span",null,"(\u5EFA\u8BAE\u767B\u9646\u540E\u8BC4\u8BBA\u54E6\uFF01)",-1)),W=p("\u63D0\u4EA4\u7559\u8A00"),X={class:"interaction_comment"},Z=["index"],tt=g(()=>n("div",{class:"interaction_comment_img"},[n("img",{src:"http://hyyyh.top:3001/icon/github.png",alt:""})],-1)),nt={class:"interaction_comment_container"},et={class:"interaction_comment_top"},it={class:"interaction_name"},ot={class:"interaction_time"},at={class:"interaction_comment_mid"},ct={class:"interaction_comment_bottom"},rt=["onClick"],st=["src"],_t=v({__name:"interaction",setup(c){const t=x({textarea:"",commentData:[],isshowtologindialog:!1,userid:localStorage.getItem("id"),username:localStorage.getItem("name"),userhasbeenlaudData:[]});B(async()=>{if(T({targets:[".interaction_body_container"],translateY:"-50vh",opacity:1,duration:1e3}),t.commentData=await(await A()).data.data,t.userid){const i=await k(parseInt(t.userid));t.userhasbeenlaudData=i.data.data.map(e=>e.interactionid),t.commentData.map(e=>{t.userhasbeenlaudData.includes(e.id)?e.islaud=!0:e.islaud=!1})}});const b=async()=>{if(!t.userid||!t.username)return s.error("\u672A\u767B\u5F55");if(t.textarea==""||t.textarea.length<5)return s.error("\u60A8\u8F93\u5165\u7684\u5B57\u6570\u4E0D\u591F\u54E6\uFF01");const i=await S(t.userid,t.username,t.textarea,"1");i.status==200?(t.commentData=i.data.data,t.commentData.map(e=>{t.userhasbeenlaudData.includes(e.id)?e.islaud=!0:e.islaud=!1}),s.success("\u7559\u8A00\u6210\u529F\uFF01")):s.error("\u7559\u8A00\u5931\u8D25\uFF01")},h=async i=>{if(t.userid){const e=await L(i.id,parseInt(t.userid));if(console.log(e),e.status==201){s.error("\u4F60\u5DF2\u7ECF\u70B9\u8D5E\u8FC7\u4E86\uFF01");return}const r=await z(i.id,parseInt(t.userid));r.status==200&&(s.success(r.data.msg),i.laudnum++,i.islaud=!0),console.log(r)}else return t.isshowtologindialog=!0},y=()=>{t.isshowtologindialog=!1};return(i,e)=>{const r=R,m=w;return u(),l(f,null,[n("div",Y,[a($,{bgColor:!0}),n("div",q,[n("div",J,[K,n("div",O,[a(r,{modelValue:t.textarea,"onUpdate:modelValue":e[0]||(e[0]=o=>t.textarea=o),rows:2,type:"textarea",placeholder:"\u7559\u4E0B\u4F60\u7684\u5EFA\u8BAE\u5427\uFF01",autosize:{minRows:5,maxRows:6}},null,8,["modelValue"]),n("div",P,[Q,a(m,{type:"primary",class:"submitbtn",onClick:b},{default:_(()=>[W]),_:1})])]),n("div",X,[(u(!0),l(f,null,C(t.commentData,(o,dt)=>(u(),l("div",{class:"interaction_comment_item",index:o.id},[tt,n("div",nt,[n("div",et,[n("span",it,d(o.username),1),n("span",ot,d(o.createtime),1)]),n("div",at,d(o.container),1),n("div",ct,[n("div",{onClick:mt=>h(o)},[n("img",{src:o.islaud?"http://hyyyh.top:3001/icon/laud_0.png":"http://hyyyh.top:3001/icon/laud.png",alt:""},null,8,st),p(d(o.laudnum),1)],8,rt)])])],8,Z))),256))])]),a(j)])]),a(H,{isshow:t.isshowtologindialog,onBack:y},null,8,["isshow"])],64)}}});var ft=E(_t,[["__scopeId","data-v-bc3483a4"]]);export{ft as default};
